import React, { useEffect, useRef, useState, forwardRef, useImperativeHandle } from "react";
import { TextRotator } from "../common/buttons/TextRotator";
import { RevealOnScroll } from "../RevealOnScroll";
import PlayIcon from "../common/icons/PlayIcon";

export const Home = () => {
  const rotatorRef = useRef(null);

  const [isStarted, setIsStarted] = useState(false);

  const groups = [
    { text: "I'm", letterDelay: 1, displayDuration: 3000 },
    { text: "good", letterDelay: 1, displayDuration: 3000 },
    { text: "yeah", letterDelay: 1, displayDuration: 3000 },
    { text: "I'm", letterDelay: 1, displayDuration: 3000 },
    { text: "feelin'", letterDelay: 1, displayDuration: 3000 },
    { text: "alright", letterDelay: 1, displayDuration: 3000 },
    { text: "Baby", letterDelay: 1, displayDuration: 3000 },
    { text: "I'ma", letterDelay: 1, displayDuration: 3000 },
    { text: "have", letterDelay: 1, displayDuration: 3000 },
    { text: "the", letterDelay: 1, displayDuration: 3000 },
    { text: "best", letterDelay: 1, displayDuration: 3000 },
    { text: "fuckin'", letterDelay: 1, displayDuration: 3000 },
    { text: "night", letterDelay: 1, displayDuration: 3000 },
    { text: "of", letterDelay: 1, displayDuration: 3000 },
    { text: "my", letterDelay: 1, displayDuration: 3000 },
    { text: "life", letterDelay: 1, displayDuration: 3000 },
    { text: "And", letterDelay: 1, displayDuration: 3000 },
    { text: "wherever", letterDelay: 1, displayDuration: 3000 },
    { text: "it", letterDelay: 1, displayDuration: 3000 },
    { text: "takes", letterDelay: 1, displayDuration: 3000 },
    { text: "me", letterDelay: 1, displayDuration: 3000 },
    { text: "I'm", letterDelay: 1, displayDuration: 3000 },
    { text: "down", letterDelay: 1, displayDuration: 3000 },
    { text: "for", letterDelay: 1, displayDuration: 3000 },
    { text: "the", letterDelay: 1, displayDuration: 3000 },
    { text: "ride", letterDelay: 1, displayDuration: 3000 },
    { text: "Baby", letterDelay: 1, displayDuration: 3000 },
    { text: "don't", letterDelay: 1, displayDuration: 3000 },
    { text: "you", letterDelay: 1, displayDuration: 3000 },
    { text: "know", letterDelay: 1, displayDuration: 3000 },
    { text: "I'm", letterDelay: 1, displayDuration: 3000 },
    { text: "good?", letterDelay: 1, displayDuration: 3000 },
    { text: "Yeah", letterDelay: 1, displayDuration: 3000 },
    { text: "I'm", letterDelay: 1, displayDuration: 3000 },
    { text: "feelin'", letterDelay: 1, displayDuration: 3000 },
    { text: "alright", letterDelay: 1, displayDuration: 3000 },
    { text: "", letterDelay: 0, displayDuration: 3000 },
    { text: "'Cause", letterDelay: 1, displayDuration: 3000 },
    { text: "I'm", letterDelay: 1, displayDuration: 3000 },
    { text: "good", letterDelay: 1, displayDuration: 3000 },
    { text: "yeah", letterDelay: 1, displayDuration: 3000 },
    { text: "I'm", letterDelay: 1, displayDuration: 3000 },
    { text: "feelin'", letterDelay: 1, displayDuration: 3000 },
    { text: "alright", letterDelay: 1, displayDuration: 3000 },
    { text: "Baby", letterDelay: 1, displayDuration: 3000 },
    { text: "I'ma", letterDelay: 1, displayDuration: 3000 },
    { text: "have", letterDelay: 1, displayDuration: 3000 },
    { text: "the", letterDelay: 1, displayDuration: 3000 },
    { text: "best", letterDelay: 1, displayDuration: 3000 },
    { text: "fuckin'", letterDelay: 1, displayDuration: 3000 },
    { text: "night", letterDelay: 1, displayDuration: 3000 },
    { text: "of", letterDelay: 1, displayDuration: 3000 },
    { text: "my", letterDelay: 1, displayDuration: 3000 },
    { text: "life", letterDelay: 1, displayDuration: 3000 },
    { text: "And", letterDelay: 1, displayDuration: 3000 },
    { text: "wherever", letterDelay: 1, displayDuration: 3000 },
    { text: "it", letterDelay: 1, displayDuration: 3000 },
    { text: "takes", letterDelay: 1, displayDuration: 3000 },
    { text: "me", letterDelay: 1, displayDuration: 3000 },
    { text: "I'm", letterDelay: 1, displayDuration: 3000 },
    { text: "down", letterDelay: 1, displayDuration: 3000 },
    { text: "for", letterDelay: 1, displayDuration: 3000 },
    { text: "the", letterDelay: 1, displayDuration: 3000 },
    { text: "ride", letterDelay: 1, displayDuration: 3000 },
    { text: "Baby", letterDelay: 1, displayDuration: 3000 },
    { text: "don't", letterDelay: 1, displayDuration: 3000 },
    { text: "you", letterDelay: 1, displayDuration: 3000 },
    { text: "know", letterDelay: 1, displayDuration: 3000 },
    { text: "I'm", letterDelay: 1, displayDuration: 3000 },
    { text: "good?", letterDelay: 1, displayDuration: 3000 },
    { text: "Yeah", letterDelay: 1, displayDuration: 3000 },
    { text: "I'm", letterDelay: 1, displayDuration: 3000 },
    { text: "feelin'", letterDelay: 1, displayDuration: 3000 },
    { text: "alright", letterDelay: 1, displayDuration: 3000 },
    { text: "", letterDelay: 0, displayDuration: 3000 },
    { text: "Don't", letterDelay: 1, displayDuration: 3000 },
    { text: "you", letterDelay: 1, displayDuration: 3000 },
    { text: "know", letterDelay: 1, displayDuration: 3000 },
    { text: "I'm", letterDelay: 1, displayDuration: 3000 },
    { text: "good?", letterDelay: 1, displayDuration: 3000 },
    { text: "Yeah", letterDelay: 1, displayDuration: 3000 },
    { text: "I'm", letterDelay: 1, displayDuration: 3000 },
    { text: "feelin'", letterDelay: 1, displayDuration: 3000 },
    { text: "alright", letterDelay: 1, displayDuration: 3000 },
    { text: "", letterDelay: 0, displayDuration: 3000 },
    { text: "You", letterDelay: 1, displayDuration: 3000 },
    { text: "know", letterDelay: 1, displayDuration: 3000 },
    { text: "I'm", letterDelay: 1, displayDuration: 3000 },
    { text: "down", letterDelay: 1, displayDuration: 3000 },
    { text: "for", letterDelay: 1, displayDuration: 3000 },
    { text: "whatever", letterDelay: 1, displayDuration: 3000 },
    { text: "tonight", letterDelay: 1, displayDuration: 3000 },
    { text: "I", letterDelay: 1, displayDuration: 3000 },
    { text: "don't", letterDelay: 1, displayDuration: 3000 },
    { text: "need", letterDelay: 1, displayDuration: 3000 },
    { text: "the", letterDelay: 1, displayDuration: 3000 },
    { text: "finer", letterDelay: 1, displayDuration: 3000 },
    { text: "things", letterDelay: 1, displayDuration: 3000 },
    { text: "in", letterDelay: 1, displayDuration: 3000 },
    { text: "life", letterDelay: 1, displayDuration: 3000 },
    { text: "No", letterDelay: 1, displayDuration: 3000 },
    { text: "matter", letterDelay: 1, displayDuration: 3000 },
    { text: "where", letterDelay: 1, displayDuration: 3000 },
    { text: "I", letterDelay: 1, displayDuration: 3000 },
    { text: "go", letterDelay: 1, displayDuration: 3000 },
    { text: "it's", letterDelay: 1, displayDuration: 3000 },
    { text: "a", letterDelay: 1, displayDuration: 3000 },
    { text: "good", letterDelay: 1, displayDuration: 3000 },
    { text: "time", letterDelay: 1, displayDuration: 3000 },
    { text: "yeah", letterDelay: 1, displayDuration: 3000 },
    { text: "And", letterDelay: 1, displayDuration: 3000 },
    { text: "I", letterDelay: 1, displayDuration: 3000 },
    { text: "I", letterDelay: 1, displayDuration: 3000 },
    { text: "don't", letterDelay: 1, displayDuration: 3000 },
    { text: "need", letterDelay: 1, displayDuration: 3000 },
    { text: "to", letterDelay: 1, displayDuration: 3000 },
    { text: "sit", letterDelay: 1, displayDuration: 3000 },
    { text: "in", letterDelay: 1, displayDuration: 3000 },
    { text: "VIP", letterDelay: 1, displayDuration: 3000 },
    { text: "Middle", letterDelay: 1, displayDuration: 3000 },
    { text: "of", letterDelay: 1, displayDuration: 3000 },
    { text: "the", letterDelay: 1, displayDuration: 3000 },
    { text: "floor", letterDelay: 1, displayDuration: 3000 },
    { text: "that's", letterDelay: 1, displayDuration: 3000 },
    { text: "where", letterDelay: 1, displayDuration: 3000 },
    { text: "I'll", letterDelay: 1, displayDuration: 3000 },
    { text: "be", letterDelay: 1, displayDuration: 3000 },
    { text: "Don't", letterDelay: 1, displayDuration: 3000 },
    { text: "got", letterDelay: 1, displayDuration: 3000 },
    { text: "a", letterDelay: 1, displayDuration: 3000 },
    { text: "lot", letterDelay: 1, displayDuration: 3000 },
    { text: "but", letterDelay: 1, displayDuration: 3000 },
    { text: "that's", letterDelay: 1, displayDuration: 3000 },
    { text: "enough", letterDelay: 1, displayDuration: 3000 },
    { text: "for", letterDelay: 1, displayDuration: 3000 },
    { text: "me", letterDelay: 1, displayDuration: 3000 },
    { text: "yeah", letterDelay: 1, displayDuration: 3000 },
    { text: "", letterDelay: 0, displayDuration: 3000 },
    { text: "'Cause", letterDelay: 1, displayDuration: 3000 },
    { text: "I'm", letterDelay: 1, displayDuration: 3000 },
    { text: "good", letterDelay: 1, displayDuration: 3000 },
    { text: "yeah", letterDelay: 1, displayDuration: 3000 },
    { text: "I'm", letterDelay: 1, displayDuration: 3000 },
    { text: "feelin'", letterDelay: 1, displayDuration: 3000 },
    { text: "alright", letterDelay: 1, displayDuration: 3000 },
    { text: "Baby", letterDelay: 1, displayDuration: 3000 },
    { text: "I'ma", letterDelay: 1, displayDuration: 3000 },
    { text: "have", letterDelay: 1, displayDuration: 3000 },
    { text: "the", letterDelay: 1, displayDuration: 3000 },
    { text: "best", letterDelay: 1, displayDuration: 3000 },
    { text: "fuckin'", letterDelay: 1, displayDuration: 3000 },
    { text: "night", letterDelay: 1, displayDuration: 3000 },
    { text: "of", letterDelay: 1, displayDuration: 3000 },
    { text: "my", letterDelay: 1, displayDuration: 3000 },
    { text: "life", letterDelay: 1, displayDuration: 3000 },
    { text: "And", letterDelay: 1, displayDuration: 3000 },
    { text: "wherever", letterDelay: 1, displayDuration: 3000 },
    { text: "it", letterDelay: 1, displayDuration: 3000 },
    { text: "takes", letterDelay: 1, displayDuration: 3000 },
    { text: "me", letterDelay: 1, displayDuration: 3000 },
    { text: "I'm", letterDelay: 1, displayDuration: 3000 },
    { text: "down", letterDelay: 1, displayDuration: 3000 },
    { text: "for", letterDelay: 1, displayDuration: 3000 },
    { text: "the", letterDelay: 1, displayDuration: 3000 },
    { text: "ride", letterDelay: 1, displayDuration: 3000 },
    { text: "Baby", letterDelay: 1, displayDuration: 3000 },
    { text: "don't", letterDelay: 1, displayDuration: 3000 },
    { text: "you", letterDelay: 1, displayDuration: 3000 },
    { text: "know", letterDelay: 1, displayDuration: 3000 },
    { text: "I'm", letterDelay: 1, displayDuration: 3000 },
    { text: "good?", letterDelay: 1, displayDuration: 3000 },
    { text: "Yeah", letterDelay: 1, displayDuration: 3000 },
    { text: "I'm", letterDelay: 1, displayDuration: 3000 },
    { text: "feelin'", letterDelay: 1, displayDuration: 3000 },
    { text: "alright", letterDelay: 1, displayDuration: 3000 },
    { text: "", letterDelay: 0, displayDuration: 3000 },
    { text: "I'm", letterDelay: 1, displayDuration: 3000 },
    { text: "good", letterDelay: 1, displayDuration: 3000 },
    { text: "Good", letterDelay: 1, displayDuration: 3000 },
    { text: "I'm", letterDelay: 1, displayDuration: 3000 },
    { text: "good", letterDelay: 1, displayDuration: 3000 },
    { text: "Don't", letterDelay: 1, displayDuration: 3000 },
    { text: "you", letterDelay: 1, displayDuration: 3000 },
    { text: "know", letterDelay: 1, displayDuration: 3000 },
    { text: "I'm", letterDelay: 1, displayDuration: 3000 },
    { text: "good?", letterDelay: 1, displayDuration: 3000 },
    { text: "Yeah", letterDelay: 1, displayDuration: 3000 },
    { text: "I'm", letterDelay: 1, displayDuration: 3000 },
    { text: "feelin'", letterDelay: 1, displayDuration: 3000 },
    { text: "alright", letterDelay: 1, displayDuration: 3000 },
    { text: "", letterDelay: 0, displayDuration: 3000 },
    { text: "So", letterDelay: 1, displayDuration: 3000 },
    { text: "I", letterDelay: 1, displayDuration: 3000 },
    { text: "just", letterDelay: 1, displayDuration: 3000 },
    { text: "let", letterDelay: 1, displayDuration: 3000 },
    { text: "it", letterDelay: 1, displayDuration: 3000 },
    { text: "go", letterDelay: 1, displayDuration: 3000 },
    { text: "let", letterDelay: 1, displayDuration: 3000 },
    { text: "it", letterDelay: 1, displayDuration: 3000 },
    { text: "go", letterDelay: 1, displayDuration: 3000 },
    { text: "Oh", letterDelay: 1, displayDuration: 3000 },
    { text: "na", letterDelay: 1, displayDuration: 3000 },
    { text: "na", letterDelay: 1, displayDuration: 3000 },
    { text: "na", letterDelay: 1, displayDuration: 3000 },
    { text: "na", letterDelay: 1, displayDuration: 3000 },
    { text: "na", letterDelay: 1, displayDuration: 3000 },
    { text: "No", letterDelay: 1, displayDuration: 3000 },
    { text: "I", letterDelay: 1, displayDuration: 3000 },
    { text: "don't", letterDelay: 1, displayDuration: 3000 },
    { text: "care", letterDelay: 1, displayDuration: 3000 },
    { text: "no", letterDelay: 1, displayDuration: 3000 },
    { text: "more", letterDelay: 1, displayDuration: 3000 },
    { text: "care", letterDelay: 1, displayDuration: 3000 },
    { text: "no", letterDelay: 1, displayDuration: 3000 },
    { text: "more", letterDelay: 1, displayDuration: 3000 },
    { text: "Oh", letterDelay: 1, displayDuration: 3000 },
    { text: "na", letterDelay: 1, displayDuration: 3000 },
    { text: "na", letterDelay: 1, displayDuration: 3000 },
    { text: "na", letterDelay: 1, displayDuration: 3000 },
    { text: "na", letterDelay: 1, displayDuration: 3000 },
    { text: "na", letterDelay: 1, displayDuration: 3000 },
    { text: "So", letterDelay: 1, displayDuration: 3000 },
    { text: "come", letterDelay: 1, displayDuration: 3000 },
    { text: "on", letterDelay: 1, displayDuration: 3000 },
    { text: "let", letterDelay: 1, displayDuration: 3000 },
    { text: "me", letterDelay: 1, displayDuration: 3000 },
    { text: "know", letterDelay: 1, displayDuration: 3000 },
    { text: "let", letterDelay: 1, displayDuration: 3000 },
    { text: "me", letterDelay: 1, displayDuration: 3000 },
    { text: "know", letterDelay: 1, displayDuration: 3000 },
    { text: "Put", letterDelay: 1, displayDuration: 3000 },
    { text: "your", letterDelay: 1, displayDuration: 3000 },
    { text: "hands", letterDelay: 1, displayDuration: 3000 },
    { text: "up", letterDelay: 1, displayDuration: 3000 },
    { text: "na", letterDelay: 1, displayDuration: 3000 },
    { text: "na", letterDelay: 1, displayDuration: 3000 },
    { text: "na", letterDelay: 1, displayDuration: 3000 },
    { text: "No", letterDelay: 1, displayDuration: 3000 },
    { text: "baby", letterDelay: 1, displayDuration: 3000 },
    { text: "nothing's", letterDelay: 1, displayDuration: 3000 },
    { text: "gonna", letterDelay: 1, displayDuration: 3000 },
    { text: "stop", letterDelay: 1, displayDuration: 3000 },
    { text: "us", letterDelay: 1, displayDuration: 3000 },
    { text: "tonight", letterDelay: 1, displayDuration: 3000 },
    { text: "", letterDelay: 0, displayDuration: 3000 },
    { text: "'Cause", letterDelay: 1, displayDuration: 3000 },
    { text: "I'm", letterDelay: 1, displayDuration: 3000 },
    { text: "good", letterDelay: 1, displayDuration: 3000 },
    { text: "yeah", letterDelay: 1, displayDuration: 3000 },
    { text: "I'm", letterDelay: 1, displayDuration: 3000 },
    { text: "feelin'", letterDelay: 1, displayDuration: 3000 },
    { text: "alright", letterDelay: 1, displayDuration: 3000 },
    { text: "Baby", letterDelay: 1, displayDuration: 3000 },
    { text: "I'ma", letterDelay: 1, displayDuration: 3000 },
    { text: "have", letterDelay: 1, displayDuration: 3000 },
    { text: "the", letterDelay: 1, displayDuration: 3000 },
    { text: "best", letterDelay: 1, displayDuration: 3000 },
    { text: "fuckin'", letterDelay: 1, displayDuration: 3000 },
    { text: "night", letterDelay: 1, displayDuration: 3000 },
    { text: "of", letterDelay: 1, displayDuration: 3000 },
    { text: "my", letterDelay: 1, displayDuration: 3000 },
    { text: "life", letterDelay: 1, displayDuration: 3000 },
    { text: "And", letterDelay: 1, displayDuration: 3000 },
    { text: "wherever", letterDelay: 1, displayDuration: 3000 },
    { text: "it", letterDelay: 1, displayDuration: 3000 },
    { text: "takes", letterDelay: 1, displayDuration: 3000 },
    { text: "me", letterDelay: 1, displayDuration: 3000 },
    { text: "I'm", letterDelay: 1, displayDuration: 3000 },
    { text: "down", letterDelay: 1, displayDuration: 3000 },
    { text: "for", letterDelay: 1, displayDuration: 3000 },
    { text: "the", letterDelay: 1, displayDuration: 3000 },
    { text: "ride", letterDelay: 1, displayDuration: 3000 },
    { text: "Baby", letterDelay: 1, displayDuration: 3000 },
    { text: "don't", letterDelay: 1, displayDuration: 3000 },
    { text: "you", letterDelay: 1, displayDuration: 3000 },
    { text: "know", letterDelay: 1, displayDuration: 3000 },
    { text: "I'm", letterDelay: 1, displayDuration: 3000 },
    { text: "good?", letterDelay: 1, displayDuration: 3000 },
    { text: "Yeah", letterDelay: 1, displayDuration: 3000 },
    { text: "I'm", letterDelay: 1, displayDuration: 3000 },
    { text: "feelin'", letterDelay: 1, displayDuration: 3000 },
    { text: "alright", letterDelay: 1, displayDuration: 3000 }
  ];

  function handleStart() {
    if (!rotatorRef.current || typeof rotatorRef.current.startSequence !== "function") return;
    setIsStarted(true);
    rotatorRef.current.startSequence(0);
  }

  function handleOnIndexChange(idx) {
    setCurrentIndex(idx);
  }

  function handleOnEnd() {
    setIsStarted(false);
  }

  return (
    <section id="home" className="min-h-screen flex items-center justify-center relative">
      <RevealOnScroll>
        <div className="text-center z-10 px-4">
          <div className="mb-8">
            <TextRotator
              ref={rotatorRef}
              groups={groups}
              defaultLetterDelay={50}
              defaultDisplayDuration={1500}
              transitionDuration={450}
              onIndexChange={handleOnIndexChange}
              onEnd={handleOnEnd}
            />
          </div>

          <div className="mt-6 flex items-center justify-center gap-4">
            <button
              onClick={handleStart}
              disabled={isStarted}
              className={`px-4 py-2 rounded-md text-white font-semibold transition ${isStarted ? 'opacity-50 cursor-not-allowed bg-gray-500' : 'bg-red-600 hover:bg-red-700'}`}
            >
              {isStarted ? <PlayIcon type={2} /> : <PlayIcon type={1} />}
            </button>
          </div>
        </div>
      </RevealOnScroll>
    </section>
  );
};

export default Home;
